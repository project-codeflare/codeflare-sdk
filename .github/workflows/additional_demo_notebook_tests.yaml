name: Additional demo notebooks tests

on:
  pull_request:
    branches: [ main ]
    types: [ labeled, synchronize ]
  workflow_dispatch:

concurrency:
  group: ${{ github.head_ref }}-${{ github.workflow }}
  cancel-in-progress: true

env:
  KUEUE_VERSION: v0.13.4
  KUBERAY_VERSION: v1.4.2

jobs:
  verify-local_interactive:
    if: ${{ contains(github.event.pull_request.labels.*.name, 'test-additional-notebooks') }}
    runs-on: ubuntu-latest

    steps:
      - name: Skip notification
        run: |
          echo "::notice::SKIPPED: verify-local_interactive test is currently disabled."
          echo ""
          echo "=============================================================================="
          echo "  TEST SKIPPED: local_interactive.ipynb"
          echo "=============================================================================="
          echo ""
          echo "  Reason: This notebook requires mTLS (mutual TLS) certificates for"
          echo "  interactive Ray connections via ray.init(address=cluster.local_client_url())."
          echo ""
          echo "  The mTLS CA secret was previously created by codeflare-operator, which has"
          echo "  been removed from the RHOAI 3.x stack. While opendatahub-io/kuberay includes"
          echo "  some mTLS features, they require OpenShift-specific components that are not"
          echo "  available in KinD."
          echo ""
          echo "  This test should be run on a full OpenShift cluster with RHOAI installed."
          echo "=============================================================================="

  verify-ray_job_client:
    if: ${{ contains(github.event.pull_request.labels.*.name, 'test-additional-notebooks') }}
    runs-on: ubuntu-latest

    steps:
      - name: Skip notification
        run: |
          echo "::notice::SKIPPED: verify-ray_job_client test is currently disabled."
          echo ""
          echo "=============================================================================="
          echo "  TEST SKIPPED: ray_job_client.ipynb"
          echo "=============================================================================="
          echo ""
          echo "  Reason: This notebook requires mTLS (mutual TLS) certificates for"
          echo "  interactive Ray connections via the Ray Job Client."
          echo ""
          echo "  The mTLS CA secret was previously created by codeflare-operator, which has"
          echo "  been removed from the RHOAI 3.x stack. While opendatahub-io/kuberay includes"
          echo "  some mTLS features, they require OpenShift-specific components that are not"
          echo "  available in KinD."
          echo ""
          echo "  This test should be run on a full OpenShift cluster with RHOAI installed."
          echo "=============================================================================="
